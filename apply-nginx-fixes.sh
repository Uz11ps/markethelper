#!/bin/bash

# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π Nginx –¥–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è —Ç–∞–π–º–∞—É—Ç–æ–≤

set -e

cd /opt/markethelper

echo "üîß –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π Nginx..."
echo ""

# –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–¥
echo "üì• –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞..."
git pull origin master

# –ö–æ–ø–∏—Ä—É–µ–º –Ω–æ–≤—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
echo ""
echo "üìù –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –Ω–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Nginx..."
cp nginx.conf /etc/nginx/sites-available/markethelper

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
echo ""
echo "üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Nginx..."
nginx -t

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º Nginx
echo ""
echo "üîÑ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ Nginx..."
systemctl reload nginx

echo ""
echo "‚úÖ Nginx –æ–±–Ω–æ–≤–ª–µ–Ω!"
echo ""
echo "üìã –ù–æ–≤—ã–µ —Ç–∞–π–º–∞—É—Ç—ã:"
echo "  - proxy_connect_timeout: 300s (5 –º–∏–Ω—É—Ç)"
echo "  - proxy_send_timeout: 300s (5 –º–∏–Ω—É—Ç)"
echo "  - proxy_read_timeout: 300s (5 –º–∏–Ω—É—Ç)"
echo ""
echo "  - AI –∑–∞–ø—Ä–æ—Å—ã: —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π location —Å —Ç–∞–π–º–∞—É—Ç–æ–º 300s"

